{# Leaf-1 #}
configure terminal
!
interface Loopback 0
 description "Router-ID"
 ip address 192.168.0.1/32
!
interface Ethernet 0
 description "Link to Spine-1"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
interface Ethernet 2
 description "Link to Spine-2"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
router ospf
 ospf router-id 192.168.0.1
 auto-cost reference-bandwidth 1000000
 !
!
interface Loopback 0
 ip ospf area 1
!
interface Ethernet 0
 ip ospf area 1
 ip ospf network point-to-point
 !
!
interface Ethernet 2
 ip ospf area 1
 ip ospf network point-to-point
 !
!
end
write mem
!

{# Leaf-3 #}
configure terminal
!
interface Loopback 0
 description "Router-ID"
 ip address 192.168.0.3/32
!
interface Ethernet 0
 description "Link to Spine-1"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
interface Ethernet 2
 description "Link to Spine-2"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
router ospf
 ospf router-id 192.168.0.3
 auto-cost reference-bandwidth 1000000
 !
!
interface Loopback 0
 ip ospf area 1
!
interface Ethernet 0
 ip ospf area 1
 ip ospf network point-to-point
 !
!
interface Ethernet 2
 ip ospf area 1
 ip ospf network point-to-point
 !
!
end
write mem
!

{# Leaf-2 #}
configure terminal
!
interface Loopback 0
 description "Router-ID"
 ip address 192.168.0.2/32
!
interface Ethernet 4
 description "Link to Spine-1"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
interface Ethernet 2
 description "Link to Spine-2"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
router ospf
 ospf router-id 192.168.0.2
 auto-cost reference-bandwidth 1000000
 !
!
interface Loopback 0
 ip ospf area 1
!
interface Ethernet 4
 ip ospf area 1
 ip ospf network point-to-point
 !
!
interface Ethernet 2
 ip ospf area 1
 ip ospf network point-to-point
 !
!
end
write mem
!

{# Spine-1 #}
configure terminal
!
interface Loopback 0
 description "Router-ID"
 ip address 192.168.0.4/32
!
interface Ethernet 0
 description "Link to Leaf-1"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
interface Ethernet 3
 description "Link to Leaf-3"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
interface Ethernet 4
 description "Link to Leaf-2"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
router ospf
 ospf router-id 192.168.0.4
 auto-cost reference-bandwidth 1000000
 !
!
interface Loopback 0
 ip ospf area 1
!
interface Ethernet 0
 ip ospf area 1
 ip ospf network point-to-point
 !
!
interface Ethernet 3
 ip ospf area 1
 ip ospf network point-to-point
 !
!
interface Ethernet 4
 ip ospf area 1
 ip ospf network point-to-point
 !
!
end
write mem
!

{# Spine-2 #}
configure terminal
!
interface Loopback 0
 description "Router-ID"
 ip address 192.168.0.5/32
!
interface Ethernet1
 description "Link to Leaf-1"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
interface Ethernet3
 description "Link to Leaf-3"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
interface Ethernet2
 description "Link to Leaf-2"
 no ip address
 ip unnumbered Loopback0
 no shutdown
 !
!
router ospf
 ospf router-id 192.168.0.5
 auto-cost reference-bandwidth 1000000
 !
!
interface Loopback 0
 ip ospf area 1
!
interface Ethernet 1
 ip ospf area 1
 ip ospf network point-to-point
 !
!
interface Ethernet 3
 ip ospf area 1
 ip ospf network point-to-point
 !
!
interface Ethernet 2
 ip ospf area 1
 ip ospf network point-to-point
 !
!
end
write mem
!

{# Leaf-1 #}
configure terminal
!
interface PortChannel 100
 no shutdown
!
interface Ethernet1
 description Peer-Link-to-Leaf-3
 channel-group 100
 no shutdown
!
interface Ethernet3
 description Peer-Link-to-Leaf-3
 channel-group 100
 no shutdown
!
!
mclag gateway-mac aa:bb:aa:bb:aa:bb
!
mclag domain 1
 source-ip 192.168.0.1
 peer-ip 192.168.0.3
 peer-link PortChannel100
 mclag-system-mac 00:00:00:22:22:22
!
interface PortChannel 1
 description To-Ubuntu-Server
 lacp interval fast
 mclag 1
 no shutdown
!
interface Ethernet4
 description Po1-Ubuntu
 channel-group 1 mode active
 no shutdown
!
end
write mem
!

{# Leaf-3 #}
configure terminal
!
interface PortChannel 100
 no shutdown
!
interface Ethernet1
 description Peer-Link-to-Leaf-1
 channel-group 100
 no shutdown
!
interface Ethernet3
 description Peer-Link-to-Leaf-1
 channel-group 100
 no shutdown
!
!
mclag gateway-mac aa:bb:aa:bb:aa:bb
!
mclag domain 1
 source-ip 192.168.0.3
 peer-ip 192.168.0.1
 peer-link PortChannel100
 mclag-system-mac 00:00:00:22:22:22
!
interface PortChannel 1
 description To-Ubuntu-Server
 mclag 1
 no shutdown
!
interface Ethernet4
 description Po1-Ubuntu
 channel-group 1 mode active
 no shutdown
!
end
write mem
!

{# Leaf-1 #}
ip vrf Vrf1
ip anycast-mac-address 00:00:22:22:22:22
ip anycast-address enable
!
interface Vlan10
 description "Green Servers VLAN"
 ip vrf forwarding Vrf1
 ip anycast-address 10.1.1.254/24
!
interface Vlan2000
 description "IRB VLAN"
 ip vrf forwarding Vrf1
 ipv6 enable
!
interface Loopback 1
 description "source ip for VXLAN interface"
 ip address 100.1.1.1/32
!
interface vxlan vtep1
 source-ip 100.1.1.1
 map vni 10010 vlan 10
 map vni 200000 vlan 2000
 map vni 200000 vrf Vrf1
!
interface PortChannel 1
 switchport trunk allowed Vlan add 10
 !
default interface Ethernet5
interface Ethernet5
 description "Link to PC-1"
 switchport access Vlan 10
 no shutdown
!

{# Leaf-3 #}
ip vrf Vrf1
ip anycast-mac-address 00:00:22:22:22:22
ip anycast-address enable
!
interface Vlan10
 description "Green Servers VLAN"
 ip vrf forwarding Vrf1
 ip anycast-address 10.1.1.254/24
!
interface Vlan11
 description "Green Servers VLAN"
 ip vrf forwarding Vrf1
 ip anycast-address 11.1.1.254/24
!
interface Vlan2000
 description "IRB VLAN"
 ip vrf forwarding Vrf1
 ipv6 enable
!
interface Loopback 1
 description "source ip for VXLAN interface"
 ip address 100.3.3.3/32
!
interface vxlan vtep1
 source-ip 100.3.3.3
 map vni 10010 vlan 10
 map vni 10011 vlan 11
 map vni 200000 vlan 2000
 map vni 200000 vrf Vrf1
!

{# Leaf-2 #}
ip vrf Vrf1
ip anycast-mac-address 00:00:22:22:22:22
ip anycast-address enable
!
interface Vlan10
 description "Green Servers VLAN"
 ip vrf forwarding Vrf1
 ip anycast-address 10.1.1.254/24
!
interface Vlan11
 description "Green Servers VLAN"
 ip vrf forwarding Vrf1
 ip anycast-address 11.1.1.254/24
!
interface Vlan2000
 description "IRB VLAN"
 ip vrf forwarding Vrf1
 ipv6 enable
!
interface Loopback 1
 description "source ip for VXLAN interface"
 ip address 100.2.2.2/32
!
interface vxlan vtep1
 source-ip 100.2.2.2
 map vni 10010 vlan 10
 map vni 10011 vlan 11
 map vni 200000 vlan 2000
 map vni 200000 vrf Vrf1
!
default interface Ethernet0
interface Ethernet0
 description "Link to PC-2"
 switchport access Vlan 10
 no shutdown
!
default interface Ethernet5
interface Ethernet5
 description "Link to PC-3"
 switchport access Vlan 11
 no shutdown
!